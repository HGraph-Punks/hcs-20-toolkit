"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/compressAndChunkMetadata";
exports.ids = ["pages/api/compressAndChunkMetadata"];
exports.modules = {

/***/ "@mongodb-js/zstd":
/*!***********************************!*\
  !*** external "@mongodb-js/zstd" ***!
  \***********************************/
/***/ ((module) => {

module.exports = require("@mongodb-js/zstd");

/***/ }),

/***/ "formidable":
/*!*****************************!*\
  !*** external "formidable" ***!
  \*****************************/
/***/ ((module) => {

module.exports = import("formidable");;

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "(api)/./pages/api/compressAndChunkMetadata.ts":
/*!***********************************************!*\
  !*** ./pages/api/compressAndChunkMetadata.ts ***!
  \***********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"config\": () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _mongodb_js_zstd__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @mongodb-js/zstd */ \"@mongodb-js/zstd\");\n/* harmony import */ var _mongodb_js_zstd__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_mongodb_js_zstd__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! formidable */ \"formidable\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_3__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([formidable__WEBPACK_IMPORTED_MODULE_1__]);\nformidable__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        // Handle non-POST requests\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    const form = (0,formidable__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();\n    form.parse(req, async (err, fields, files)=>{\n        if (err) {\n            console.error(\"Formidable parsing error:\", err);\n            return res.status(500).json({\n                success: false,\n                error: \"Error parsing form data\"\n            });\n        }\n        try {\n            const metadataFile = files.metadata[0]; // Assuming there's only one metadata file\n            const topicIds = JSON.parse(fields.topicIds); // Assuming topicIds is a JSON array string\n            console.log(topicIds);\n            if (!metadataFile) {\n                return res.status(400).json({\n                    success: false,\n                    error: \"No metadata file uploaded\"\n                });\n            }\n            if (!topicIds) {\n                return res.status(400).json({\n                    success: false,\n                    error: \"No topic IDs provided\"\n                });\n            }\n            const metadataContent = fs__WEBPACK_IMPORTED_MODULE_2___default().readFileSync(metadataFile.filepath, \"utf8\");\n            let metadataJson = JSON.parse(metadataContent);\n            // Update the image attribute for each metadata object\n            metadataJson = metadataJson.map((item, index)=>{\n                const topicId = topicIds[index].newTopicId; // Match by the same index\n                if (topicId) {\n                    console.log(topicId);\n                    const newItem = item;\n                    delete newItem.edition;\n                    delete newItem.imageHash;\n                    return {\n                        ...newItem,\n                        image: `hcs://1/${topicId}`\n                    };\n                }\n                return item; // Return the item unchanged if no corresponding topicId\n            });\n            // Convert updated metadata back to Buffer for hashing and compression\n            let finalJson = [];\n            for(let i = 0; i < metadataJson.length; i++){\n                const updatedMetadata = JSON.stringify(metadataJson[i]);\n                const updatedBuffer = Buffer.from(updatedMetadata);\n                const fileHash = generateFileHash(updatedBuffer);\n                const compressedData = await (0,_mongodb_js_zstd__WEBPACK_IMPORTED_MODULE_0__.compress)(updatedBuffer, 10);\n                const base64Data = compressedData.toString(\"base64\");\n                const chunkSize = 900; // Adjust chunk size as needed\n                const dataPrefix = `data:application/json;base64,`;\n                const chunks = chunkMessage(base64Data, chunkSize, dataPrefix);\n                finalJson.push({\n                    index: i,\n                    chunks,\n                    fileHash\n                });\n            }\n            // Sending updated metadata back\n            res.status(200).json({\n                success: true,\n                finalJson\n            });\n        } catch (error) {\n            console.error(\"Error processing metadata:\", error);\n            res.status(500).json({\n                success: false,\n                error: `Error processing metadata: ${error.message}`\n            });\n        }\n    });\n}\nfunction chunkMessage(message, chunkSize, prefix) {\n    let messageArray = [];\n    for(let o = 0, offset = 0; offset < message.length; o++, offset += chunkSize){\n        const chunkContent = o === 0 ? prefix + message.substring(offset, offset + chunkSize) : message.substring(offset, offset + chunkSize);\n        messageArray.push({\n            o,\n            c: chunkContent\n        });\n    }\n    return messageArray;\n}\nfunction generateFileHash(file) {\n    const hash = crypto__WEBPACK_IMPORTED_MODULE_3___default().createHash(\"sha256\");\n    hash.update(file);\n    return hash.digest(\"hex\");\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvY29tcHJlc3NBbmRDaHVua01ldGFkYXRhLnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUE0QztBQUNSO0FBQ2hCO0FBQ1E7QUFFckIsTUFBTUksTUFBTSxHQUFHO0lBQ2xCQyxHQUFHLEVBQUU7UUFDREMsVUFBVSxFQUFFLEtBQUs7S0FDcEI7Q0FDSixDQUFDO0FBRWEsZUFBZUMsT0FBTyxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsRUFBRTtJQUM1QyxJQUFJRCxHQUFHLENBQUNFLE1BQU0sS0FBSyxNQUFNLEVBQUU7UUFDdkIsMkJBQTJCO1FBQzNCLE9BQU9ELEdBQUcsQ0FBQ0UsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7WUFBRUMsS0FBSyxFQUFFLG9CQUFvQjtTQUFFLENBQUMsQ0FBQztJQUNqRSxDQUFDO0lBRUQsTUFBTUMsSUFBSSxHQUFHYixzREFBVSxFQUFFO0lBQ3pCYSxJQUFJLENBQUNDLEtBQUssQ0FBQ1AsR0FBRyxFQUFFLE9BQU9RLEdBQUcsRUFBRUMsTUFBTSxFQUFFQyxLQUFLLEdBQUs7UUFDMUMsSUFBSUYsR0FBRyxFQUFFO1lBQ0xHLE9BQU8sQ0FBQ04sS0FBSyxDQUFDLDJCQUEyQixFQUFFRyxHQUFHLENBQUMsQ0FBQztZQUNoRCxPQUFPUCxHQUFHLENBQUNFLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO2dCQUFFUSxPQUFPLEVBQUUsS0FBSztnQkFBRVAsS0FBSyxFQUFFLHlCQUF5QjthQUFFLENBQUMsQ0FBQztRQUN0RixDQUFDO1FBRUQsSUFBSTtZQUNBLE1BQU1RLFlBQVksR0FBR0gsS0FBSyxDQUFDSSxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUUsMENBQTBDO1lBQ2xGLE1BQU1DLFFBQVEsR0FBR0MsSUFBSSxDQUFDVCxLQUFLLENBQUNFLE1BQU0sQ0FBQ00sUUFBUSxDQUFDLEVBQUUsMkNBQTJDO1lBQ3pGSixPQUFPLENBQUNNLEdBQUcsQ0FB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a01ldGFkYXRhLnRzP2E4YjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29tcHJlc3MgfSBmcm9tICdAbW9uZ29kYi1qcy96c3RkJztcbmltcG9ydCBmb3JtaWRhYmxlIGZyb20gJ2Zvcm1pZGFibGUnO1xuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbmltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgICBhcGk6IHtcbiAgICAgICAgYm9keVBhcnNlcjogZmFsc2UsXG4gICAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgICBpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XG4gICAgICAgIC8vIEhhbmRsZSBub24tUE9TVCByZXF1ZXN0c1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBlcnJvcjogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgZm9ybSA9IGZvcm1pZGFibGUoKTtcbiAgICBmb3JtLnBhcnNlKHJlcSwgYXN5bmMgKGVyciwgZmllbGRzLCBmaWxlcykgPT4ge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGb3JtaWRhYmxlIHBhcnNpbmcgZXJyb3I6JywgZXJyKTtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0Vycm9yIHBhcnNpbmcgZm9ybSBkYXRhJyB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBtZXRhZGF0YUZpbGUgPSBmaWxlcy5tZXRhZGF0YVswXTsgLy8gQXNzdW1pbmcgdGhlcmUncyBvbmx5IG9uZSBtZXRhZGF0YSBmaWxlXG4gICAgICAgICAgICBjb25zdCB0b3BpY0lkcyA9IEpTT04ucGFyc2UoZmllbGRzLnRvcGljSWRzKTsgLy8gQXNzdW1pbmcgdG9waWNJZHMgaXMgYSBKU09OIGFycmF5IHN0cmluZ1xuICAgICAgICAgICAgY29uc29sZS5sb2codG9waWNJZHMpXG4gICAgICAgICAgICBpZiAoIW1ldGFkYXRhRmlsZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ05vIG1ldGFkYXRhIGZpbGUgdXBsb2FkZWQnIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0b3BpY0lkcykge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ05vIHRvcGljIElEcyBwcm92aWRlZCcgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IG1ldGFkYXRhQ29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhtZXRhZGF0YUZpbGUuZmlsZXBhdGgsICd1dGY4Jyk7XG4gICAgICAgICAgICBsZXQgbWV0YWRhdGFKc29uID0gSlNPTi5wYXJzZShtZXRhZGF0YUNvbnRlbnQpO1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIGltYWdlIGF0dHJpYnV0ZSBmb3IgZWFjaCBtZXRhZGF0YSBvYmplY3RcbiAgICAgICAgICAgIG1ldGFkYXRhSnNvbiA9IG1ldGFkYXRhSnNvbi5tYXAoKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdG9waWNJZCA9IHRvcGljSWRzW2luZGV4XS5uZXdUb3BpY0lkOyAvLyBNYXRjaCBieSB0aGUgc2FtZSBpbmRleFxuICAgICAgICAgICAgICAgIGlmICh0b3BpY0lkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRvcGljSWQpXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0l0ZW0gPSBpdGVtXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBuZXdJdGVtLmVkaXRpb25cbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG5ld0l0ZW0uaW1hZ2VIYXNoXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IC4uLm5ld0l0ZW0sIGltYWdlOiBgaGNzOi8vMS8ke3RvcGljSWR9YCB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbTsgLy8gUmV0dXJuIHRoZSBpdGVtIHVuY2hhbmdlZCBpZiBubyBjb3JyZXNwb25kaW5nIHRvcGljSWRcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBDb252ZXJ0IHVwZGF0ZWQgbWV0YWRhdGEgYmFjayB0byBCdWZmZXIgZm9yIGhhc2hpbmcgYW5kIGNvbXByZXNzaW9uXG4gICAgICAgICAgICBsZXQgZmluYWxKc29uID0gW11cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWV0YWRhdGFKc29uLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdXBkYXRlZE1ldGFkYXRhID0gSlNPTi5zdHJpbmdpZnkobWV0YWRhdGFKc29uW2ldKTtcbiAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkQnVmZmVyID0gQnVmZmVyLmZyb20odXBkYXRlZE1ldGFkYXRhKTtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlSGFzaCA9IGdlbmVyYXRlRmlsZUhhc2godXBkYXRlZEJ1ZmZlcik7XG4gICAgICAgICAgICAgICAgY29uc3QgY29tcHJlc3NlZERhdGEgPSBhd2FpdCBjb21wcmVzcyh1cGRhdGVkQnVmZmVyLCAxMCk7XG4gICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0RGF0YSA9IGNvbXByZXNzZWREYXRhLnRvU3RyaW5nKCdiYXNlNjQnKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGNodW5rU2l6ZSA9IDkwMDsgLy8gQWRqdXN0IGNodW5rIHNpemUgYXMgbmVlZGVkXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YVByZWZpeCA9IGBkYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGA7XG4gICAgICAgICAgICAgICAgY29uc3QgY2h1bmtzID0gY2h1bmtNZXNzYWdlKGJhc2U2NERhdGEsIGNodW5rU2l6ZSwgZGF0YVByZWZpeCk7XG4gICAgICAgICAgICAgICAgZmluYWxKc29uLnB1c2goIHsgaW5kZXg6aSxjaHVua3MsIGZpbGVIYXNoIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2VuZGluZyB1cGRhdGVkIG1ldGFkYXRhIGJhY2tcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgZmluYWxKc29uIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcHJvY2Vzc2luZyBtZXRhZGF0YTonLCBlcnJvcik7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogYEVycm9yIHByb2Nlc3NpbmcgbWV0YWRhdGE6ICR7ZXJyb3IubWVzc2FnZX1gIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGNodW5rTWVzc2FnZShtZXNzYWdlLCBjaHVua1NpemUsIHByZWZpeCkge1xuICAgIGxldCBtZXNzYWdlQXJyYXkgPSBbXTtcbiAgICBmb3IgKGxldCBvID0gMCwgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgbWVzc2FnZS5sZW5ndGg7IG8rKywgb2Zmc2V0ICs9IGNodW5rU2l6ZSkge1xuICAgICAgICBjb25zdCBjaHVua0NvbnRlbnQgPSBvID09PSAwID8gcHJlZml4ICsgbWVzc2FnZS5zdWJzdHJpbmcob2Zmc2V0LCBvZmZzZXQgKyBjaHVua1NpemUpIDogbWVzc2FnZS5zdWJzdHJpbmcob2Zmc2V0LCBvZmZzZXQgKyBjaHVua1NpemUpO1xuICAgICAgICBtZXNzYWdlQXJyYXkucHVzaCh7XG4gICAgICAgICAgICBvLCAvLyBPcmRlclxuICAgICAgICAgICAgYzogY2h1bmtDb250ZW50LCAvLyBDb250ZW50XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZUFycmF5O1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUZpbGVIYXNoKGZpbGUpIHtcbiAgICBjb25zdCBoYXNoID0gY3J5cHRvLmNyZWF0ZUhhc2goJ3NoYTI1NicpO1xuICAgIGhhc2gudXBkYXRlKGZpbGUpO1xuICAgIHJldHVybiBoYXNoLmRpZ2VzdCgnaGV4Jyk7XG59XG4iXSwibmFtZXMiOlsiY29tcHJlc3MiLCJmb3JtaWRhYmxlIiwiZnMiLCJjcnlwdG8iLCJjb25maWciLCJhcGkiLCJib2R5UGFyc2VyIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImZvcm0iLCJwYXJzZSIsImVyciIsImZpZWxkcyIsImZpbGVzIiwiY29uc29sZSIsInN1Y2Nlc3MiLCJtZXRhZGF0YUZpbGUiLCJtZXRhZGF0YSIsInRvcGljSWRzIiwiSlNPTiIsImxvZyIsIm1ldGFkYXRhQ29udGVudCIsInJlYWRGaWxlU3luYyIsImZpbGVwYXRoIiwibWV0YWRhdGFKc29uIiwibWFwIiwiaXRlbSIsImluZGV4IiwidG9waWNJZCIsIm5ld1RvcGljSWQiLCJuZXdJdGVtIiwiZWRpdGlvbiIsImltYWdlSGFzaCIsImltYWdlIiwiZmluYWxKc29uIiwiaSIsImxlbmd0aCIsInVwZGF0ZWRNZXRhZGF0YSIsInN0cmluZ2lmeSIsInVwZGF0ZWRCdWZmZXIiLCJCdWZmZXIiLCJmcm9tIiwiZmlsZUhhc2giLCJnZW5lcmF0ZUZpbGVIYXNoIiwiY29tcHJlc3NlZERhdGEiLCJiYXNlNjREYXRhIiwidG9TdHJpbmciLCJjaHVua1NpemUiLCJkYXRhUHJlZml4IiwiY2h1bmtzIiwiY2h1bmtNZXNzYWdlIiwicHVzaCIsIm1lc3NhZ2UiLCJwcmVmaXgiLCJtZXNzYWdlQXJyYXkiLCJvIiwib2Zmc2V0IiwiY2h1bmtDb250ZW50Iiwic3Vic3RyaW5nIiwiYyIsImZpbGUiLCJoYXNoIiwiY3JlYXRlSGFzaCIsInVwZGF0ZSIsImRpZ2VzdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/compressAndChunkMetadata.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/compressAndChunkMetadata.ts"));
module.exports = __webpack_exports__;

})();